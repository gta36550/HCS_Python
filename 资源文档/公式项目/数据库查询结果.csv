Name,Condition,DisplayCondition,AccountA,AccountB,TaxFlag,AddDelFlag,TotalFlag,code,payflag,payvisible,Condition_Len,DisplayCondition_Len,ClickFlagStr,Condition_New
个人社保公积金合计,"select isnull(( select top 1 isnull(ysman,0) from RS_EmpSheBaopay_SE where id=EMPID and SMonth=MYDATE ),0)  + isnull(( select top 1 isnull(manp,0) from RS_EmpSheBaopay_SE where id=EMPID and SMonth=MYDATE ),0)  ","个人社保公积金合计 = 应收金额个人合计 + 公积金个人缴存 ",NULL,NULL,0,0,NULL,01,0,1,NULL,NULL,"  isnull(ysman,0) + isnull(manp,0) ",NULL
个税专项抵扣合计,"select isnull(( select top 1 deduction from SalaryTax where dname='子女教育' and id=EMPID and Month=MYDATE ),0)  + isnull(( select top 1 deduction from SalaryTax where dname='继续教育' and id=EMPID and Month=MYDATE ),0)  + isnull(( select top 1 deduction from SalaryTax where dname='赡养老人' and id=EMPID and Month=MYDATE ),0)  + isnull(( select top 1 deduction from SalaryTax where dname='首房贷款' and id=EMPID and Month=MYDATE ),0)  + isnull(( select top 1 deduction from SalaryTax where dname='住房租金' and id=EMPID and Month=MYDATE ),0)  + isnull(( select top 1 deduction from SalaryTax where dname='三岁以下婴幼儿照护' and id=EMPID and Month=MYDATE ),0)  ","个税专项抵扣合计 = 子女教育 + 继续教育 + 赡养老人 + 首房贷款 + 住房租金 + 三岁以下婴幼儿照护 ",NULL,NULL,0,0,NULL,01,0,1,NULL,NULL,"  isnull(子女教育,0) + isnull(继续教育,0) + isnull(赡养老人,0) + isnull(首房贷款,0) + isnull(住房租金,0) + isnull(三岁以下婴幼儿照护,0) ",NULL
加班工资,"if isnull(( select top 1 isnull(有无延时,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 0 and isnull(( select top 1 isnull(岗位人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1      select ( isnull(( select top 1 isnull(月薪,0) from gongshiresult ),0)  / 22 ) * isnull(( select top 1 isnull(加班天数,0) from gongshiresult ),0)  * 1.5  else  if isnull(( select top 1 isnull(岗位人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1 and isnull(( select top 1 isnull(有无延时,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1      select ( isnull(( select top 1 isnull(月薪,0) from gongshiresult ),0)  / 22 ) * isnull(( select top 1 isnull(加班天数,0) from gongshiresult ),0)  * 2  else if isnull(( select top 1 isnull(计时人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1     select isnull(( select top 1 isnull(加班时数,0) from gongshiresult ),0)  * isnull(( select top 1 isnull(小时工资,0) from gongshiresult ),0)  * 0.5 ","if 有无延时 = 0 and 岗位人员 = 1 
    加班工资 = ( 月薪 / 22 ) * 加班天数 * 1.5 
else 
if 岗位人员 = 1 and 有无延时 = 1 
    加班工资 = ( 月薪 / 22 ) * 加班天数 * 2 
else
if 计时人员 = 1 
   加班工资 = 加班时数 * 小时工资 * 0.5 ",NULL,NULL,0,1,NULL,03,0,1,NULL,NULL," case when isnull(有无延时,0) = 0 and isnull(岗位人员,0) = 1       then  ( isnull(月薪,0) / 22 ) * isnull(加班天数,0) * 1.5    when  isnull(岗位人员,0) = 1 and isnull(有无延时,0) = 1       then  ( isnull(月薪,0) / 22 ) * isnull(加班天数,0) * 2    when  isnull(计时人员,0) = 1      then  isnull(加班时数,0) * isnull(小时工资,0) * 0.5  end",NULL
节假日工资,"if isnull(( select top 1 isnull(法定满勤数,0) from XZ_ChgItemPay where ID=EMPID  and SelMonth=MYDATE),0)  > 0 and isnull(( select top 1 isnull(岗位人员,0) from XZ_FixItemPay where ID=EMPID  and SelMonth=MYDATE),0)  = 1     select ( isnull(( select top 1 isnull(月薪,0) from gongshiresult ),0)  / isnull(( select top 1 isnull(法定满勤数,0) from XZ_ChgItemPay where ID=EMPID  and SelMonth=MYDATE),0)  ) * isnull(( select top 1 isnull(节假日出勤数,0) from gongshiresult ),0)  * 3 else  if isnull(( select top 1 isnull(计时人员,0) from XZ_FixItemPay where ID=EMPID  and SelMonth=MYDATE),0)  = 1     select isnull(( select top 1 isnull(小时工资,0) from gongshiresult ),0)  * isnull(( select top 1 isnull(节假日出勤数,0) from gongshiresult ),0)  * 3 ","if 法定满勤数 > 0 and 岗位人员 = 1 
   节假日工资 = ( 月薪 / 法定满勤数 ) * 节假日出勤数 * 3
else 
if 计时人员 = 1 
   节假日工资 = 小时工资 * 节假日出勤数 * 3 ",NULL,NULL,0,1,NULL,02,0,1,NULL,NULL," case when isnull(法定满勤数,0) > 0 and isnull(岗位人员,0) = 1      then  ( isnull(月薪,0) / isnull(法定满勤数,0) ) * isnull(节假日出勤数,0) * 3   when  isnull(计时人员,0) = 1      then  isnull(小时工资,0) * isnull(节假日出勤数,0) * 3  end",NULL
缺勤扣款,"if isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID  and SelMonth=MYDATE),0)  > 0     select ( isnull(( select top 1 isnull(加班工资,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(平时出勤工资,0) from gongshiresult ),0)  ) / isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID  and SelMonth=MYDATE),0)  * isnull(( select top 1 isnull(缺勤天数,0) from gongshiresult ),0)  ","if 公司满勤数 > 0 
   缺勤扣款 = ( 加班工资 + 平时出勤工资 ) / 公司满勤数 * 缺勤天数 ",NULL,NULL,0,0,NULL,04,0,1,NULL,NULL," case when isnull(公司满勤数,0) > 0      then  ( isnull(加班工资,0) + isnull(平时出勤工资,0) ) / isnull(公司满勤数,0) * isnull(缺勤天数,0)  end",NULL
计算月工资,"if isnull(( select top 1 isnull(岗位人员,0) from XZ_FixItemPay where ID=EMPID  and SelMonth=MYDATE),0)  = 1  select isnull(( select top 1 isnull(平时出勤工资,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(加班工资,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(节假日工资,0) from gongshiresult ),0)  - isnull(( select top 1 isnull(缺勤扣款,0) from gongshiresult ),0)   else  if isnull(( select top 1 isnull(计时人员,0) from XZ_FixItemPay where ID=EMPID  and SelMonth=MYDATE),0)  = 1  select isnull(( select top 1 isnull(出勤工资,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(加班工资,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(节假日工资,0) from gongshiresult ),0)   else if isnull(( select top 1 isnull(计件人员,0) from XZ_FixItemPay where ID=EMPID  and SelMonth=MYDATE),0)  = 1  select isnull(( select top 1 isnull(计算月工资计件,0) from XZ_ChgItemPay where ID=EMPID  and SelMonth=MYDATE),0)  ","if 岗位人员 = 1 
计算月工资 = 平时出勤工资 + 加班工资 + 节假日工资 - 缺勤扣款 
else 
if 计时人员 = 1 
计算月工资 = 出勤工资 + 加班工资 + 节假日工资 
else
if 计件人员 = 1 
计算月工资 = 计算月工资计件 ",NULL,NULL,0,1,NULL,05,0,1,NULL,NULL," case when isnull(岗位人员,0) = 1   then  isnull(平时出勤工资,0) + isnull(加班工资,0) + isnull(节假日工资,0) - isnull(缺勤扣款,0)    when  isnull(计时人员,0) = 1   then  isnull(出勤工资,0) + isnull(加班工资,0) + isnull(节假日工资,0)    when  isnull(计件人员,0) = 1   then  isnull(计算月工资计件,0)  end",NULL
考核工资,"if isnull(( select top 1 isnull(岗位人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1  select isnull(( select top 1 isnull(计算月工资,0) from gongshiresult ),0)  * ( isnull(( select top 1 isnull(考核系数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - 1 ) ","if 岗位人员 = 1 
考核工资 = 计算月工资 * ( 考核系数 - 1 ) ",NULL,NULL,0,1,NULL,06,0,1,NULL,NULL," case when isnull(岗位人员,0) = 1   then  isnull(计算月工资,0) * ( isnull(考核系数,0) - 1 )  end",NULL
学历补贴,"if datediff ( day , isnull(( select top 1 HIREDATE from employee e where e.id=EMPID),0)  , isnull(( select Month from SalarygongshiItem),0)  ) <= 16 and day ( isnull(( select top 1 HIREDATE from employee e where e.id=EMPID),0)  ) >= 16     select 0  else if isnull(( select top 1 isnull(岗位人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = '1' and isnull(( select top 1 isnull(有无延时,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  = '2' and isnull(( select top 1 isnull(缺勤天数,0) from gongshiresult ),0)  > '0' and isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  > 0     select ( isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(缺勤天数,0) from gongshiresult ),0)  ) / isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  * isnull(( select top 1 isnull(学历补贴标准,0) from gongshiresult ),0)   else if isnull(( select top 1 isnull(岗位人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = '1' and ( isnull(( select top 1 isnull(有无延时,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  = '2' or ( isnull(( select top 1 isnull(平时出勤数,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(加班天数,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(节假日出勤数,0) from gongshiresult ),0)  - isnull(( select top 1 isnull(缺勤天数,0) from gongshiresult ),0)  ) >= isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  )     select isnull(( select top 1 isnull(学历补贴标准,0) from gongshiresult ),0)   else if isnull(( select top 1 isnull(岗位人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = '1' and isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  > 0     select ( isnull(( select top 1 isnull(平时出勤数,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(加班天数,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(节假日出勤数,0) from gongshiresult ),0)  - isnull(( select top 1 isnull(缺勤天数,0) from gongshiresult ),0)  ) / isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  * isnull(( select top 1 isnull(学历补贴标准,0) from gongshiresult ),0)   else if isnull(( select top 1 isnull(计时人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = '1' or isnull(( select top 1 isnull(计件人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = '1' and isnull(( select top 1 isnull(出勤时数,0) from gongshiresult ),0)  >= isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)      select isnull(( select top 1 isnull(学历补贴标准,0) from gongshiresult ),0)   else if isnull(( select top 1 isnull(计时人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = '1' or isnull(( select top 1 isnull(计件人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = '1' and isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  > 0     select isnull(( select top 1 isnull(出勤时数,0) from gongshiresult ),0)  / isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  * isnull(( select top 1 isnull(学历补贴标准,0) from gongshiresult ),0)  ","if datediff ( day , 入职日期 , 薪酬统计月份 ) <= 16 and day ( 入职日期 ) >= 16 
   学历补贴 = 0 
else
if 岗位人员 = '1' and 有无延时 = '2' and 缺勤天数 > '0' and 公司满勤数 > 0 
   学历补贴 = ( 公司满勤数 - 缺勤天数 ) / 公司满勤数 * 学历补贴标准 
else
if 岗位人员 = '1' and ( 有无延时 = '2' or ( 平时出勤数 + 加班天数 + 节假日出勤数 - 缺勤天数 ) >= 公司满勤数 ) 
   学历补贴 = 学历补贴标准 
else
if 岗位人员 = '1' and 公司满勤数 > 0 
   学历补贴 = ( 平时出勤数 + 加班天数 + 节假日出勤数 - 缺勤天数 ) / 公司满勤数 * 学历补贴标准 
else
if 计时人员 = '1' or 计件人员 = '1' and 出勤时数 >= 公司满勤数 
   学历补贴 = 学历补贴标准 
else
if 计时人员 = '1' or 计件人员 = '1' and 公司满勤数 > 0 
   学历补贴 = 出勤时数 / 公司满勤数 * 学历补贴标准 ",NULL,NULL,0,1,NULL,02,0,1,NULL,NULL," case when datediff ( day , isnull(HIREDATE,0) , isnull(Month,0) ) <= 16 and day ( isnull(HIREDATE,0) ) >= 16      then  0    when  isnull(岗位人员,0) = '1' and isnull(有无延时,0) = '2' and isnull(缺勤天数,0) > '0' and isnull(公司满勤数,0) > 0      then  ( isnull(公司满勤数,0) - isnull(缺勤天数,0) ) / isnull(公司满勤数,0) * isnull(学历补贴标准,0)    when  isnull(岗位人员,0) = '1' and ( isnull(有无延时,0) = '2' or ( isnull(平时出勤数,0) + isnull(加班天数,0) + isnull(节假日出勤数,0) - isnull(缺勤天数,0) ) >= isnull(公司满勤数,0) )      then  isnull(学历补贴标准,0)    when  isnull(岗位人员,0) = '1' and isnull(公司满勤数,0) > 0      then  ( isnull(平时出勤数,0) + isnull(加班天数,0) + isnull(节假日出勤数,0) - isnull(缺勤天数,0) ) / isnull(公司满勤数,0) * isnull(学历补贴标准,0)    when  isnull(计时人员,0) = '1' or isnull(计件人员,0) = '1' and isnull(出勤时数,0) >= isnull(公司满勤数,0)      then  isnull(学历补贴标准,0)    when  isnull(计时人员,0) = '1' or isnull(计件人员,0) = '1' and isnull(公司满勤数,0) > 0      then  isnull(出勤时数,0) / isnull(公司满勤数,0) * isnull(学历补贴标准,0)  end",NULL
职称补贴,"if datediff ( day , isnull(( select top 1 HIREDATE from employee e where e.id=EMPID),0)  , isnull(( select Month from SalarygongshiItem),0)  ) <= 16 and day ( isnull(( select top 1 HIREDATE from employee e where e.id=EMPID),0)  ) >= 16     select 0  else if isnull(( select top 1 isnull(岗位人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = '1' and isnull(( select top 1 isnull(有无延时,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  = '2' and isnull(( select top 1 isnull(缺勤天数,0) from gongshiresult ),0)  > '0' and isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  > 0     select ( isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(缺勤天数,0) from gongshiresult ),0)  ) / isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  * isnull(( select top 1 isnull(职称补贴标准,0) from gongshiresult ),0)   else if isnull(( select top 1 isnull(岗位人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = '1' and ( isnull(( select top 1 isnull(有无延时,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  = '2' or ( isnull(( select top 1 isnull(平时出勤数,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(加班天数,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(节假日出勤数,0) from gongshiresult ),0)  - isnull(( select top 1 isnull(缺勤天数,0) from gongshiresult ),0)  ) >= isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  )     select isnull(( select top 1 isnull(职称补贴标准,0) from gongshiresult ),0)   else if isnull(( select top 1 isnull(岗位人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = '1' and isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  > 0     select ( isnull(( select top 1 isnull(平时出勤数,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(加班天数,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(节假日出勤数,0) from gongshiresult ),0)  - isnull(( select top 1 isnull(缺勤天数,0) from gongshiresult ),0)  ) / isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  * isnull(( select top 1 isnull(职称补贴标准,0) from gongshiresult ),0)   else if isnull(( select top 1 isnull(计时人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = '1' or isnull(( select top 1 isnull(计件人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = '1' and isnull(( select top 1 isnull(出勤时数,0) from gongshiresult ),0)  >= isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)      select isnull(( select top 1 isnull(职称补贴标准,0) from gongshiresult ),0)   else if isnull(( select top 1 isnull(计时人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = '1' or isnull(( select top 1 isnull(计件人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = '1' and isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  > 0     select isnull(( select top 1 isnull(出勤时数,0) from gongshiresult ),0)  / isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  * isnull(( select top 1 isnull(职称补贴标准,0) from gongshiresult ),0)  ","if datediff ( day , 入职日期 , 薪酬统计月份 ) <= 16 and day ( 入职日期 ) >= 16 
   职称补贴 = 0 
else
if 岗位人员 = '1' and 有无延时 = '2' and 缺勤天数 > '0' and 公司满勤数 > 0 
   职称补贴 = ( 公司满勤数 - 缺勤天数 ) / 公司满勤数 * 职称补贴标准 
else
if 岗位人员 = '1' and ( 有无延时 = '2' or ( 平时出勤数 + 加班天数 + 节假日出勤数 - 缺勤天数 ) >= 公司满勤数 ) 
   职称补贴 = 职称补贴标准 
else
if 岗位人员 = '1' and 公司满勤数 > 0 
   职称补贴 = ( 平时出勤数 + 加班天数 + 节假日出勤数 - 缺勤天数 ) / 公司满勤数 * 职称补贴标准 
else
if 计时人员 = '1' or 计件人员 = '1' and 出勤时数 >= 公司满勤数 
   职称补贴 = 职称补贴标准 
else
if 计时人员 = '1' or 计件人员 = '1' and 公司满勤数 > 0 
   职称补贴 = 出勤时数 / 公司满勤数 * 职称补贴标准 ",NULL,NULL,0,1,NULL,02,0,1,NULL,NULL," case when datediff ( day , isnull(HIREDATE,0) , isnull(Month,0) ) <= 16 and day ( isnull(HIREDATE,0) ) >= 16      then  0    when  isnull(岗位人员,0) = '1' and isnull(有无延时,0) = '2' and isnull(缺勤天数,0) > '0' and isnull(公司满勤数,0) > 0      then  ( isnull(公司满勤数,0) - isnull(缺勤天数,0) ) / isnull(公司满勤数,0) * isnull(职称补贴标准,0)    when  isnull(岗位人员,0) = '1' and ( isnull(有无延时,0) = '2' or ( isnull(平时出勤数,0) + isnull(加班天数,0) + isnull(节假日出勤数,0) - isnull(缺勤天数,0) ) >= isnull(公司满勤数,0) )      then  isnull(职称补贴标准,0)    when  isnull(岗位人员,0) = '1' and isnull(公司满勤数,0) > 0      then  ( isnull(平时出勤数,0) + isnull(加班天数,0) + isnull(节假日出勤数,0) - isnull(缺勤天数,0) ) / isnull(公司满勤数,0) * isnull(职称补贴标准,0)    when  isnull(计时人员,0) = '1' or isnull(计件人员,0) = '1' and isnull(出勤时数,0) >= isnull(公司满勤数,0)      then  isnull(职称补贴标准,0)    when  isnull(计时人员,0) = '1' or isnull(计件人员,0) = '1' and isnull(公司满勤数,0) > 0      then  isnull(出勤时数,0) / isnull(公司满勤数,0) * isnull(职称补贴标准,0)  end",NULL
高温补贴,"if isnull(( select top 1 isnull(岗位人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = '1' and isnull(( select top 1 isnull(有无延时,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  = '2' and isnull(( select top 1 isnull(缺勤天数,0) from gongshiresult ),0)  > '0' and isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  > 0     select ( isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(缺勤天数,0) from gongshiresult ),0)  ) / isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  * isnull(( select top 1 isnull(高温补贴标准,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)   else if isnull(( select top 1 isnull(岗位人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = '1' and ( isnull(( select top 1 isnull(有无延时,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  = '2' or ( isnull(( select top 1 isnull(平时出勤数,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(加班天数,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(节假日出勤数,0) from gongshiresult ),0)  - isnull(( select top 1 isnull(缺勤天数,0) from gongshiresult ),0)  ) >= isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  )     select isnull(( select top 1 isnull(高温补贴标准,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)   else if isnull(( select top 1 isnull(岗位人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = '1' and isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  > 0     select ( isnull(( select top 1 isnull(平时出勤数,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(加班天数,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(节假日出勤数,0) from gongshiresult ),0)  - isnull(( select top 1 isnull(缺勤天数,0) from gongshiresult ),0)  ) / isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  * isnull(( select top 1 isnull(高温补贴标准,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)   else if isnull(( select top 1 isnull(计时人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = '1' or isnull(( select top 1 isnull(计件人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = '1' and isnull(( select top 1 isnull(出勤时数,0) from gongshiresult ),0)  >= isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)      select isnull(( select top 1 isnull(高温补贴标准,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)   else if isnull(( select top 1 isnull(计时人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = '1' or isnull(( select top 1 isnull(计件人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = '1' and isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  > 0     select isnull(( select top 1 isnull(出勤时数,0) from gongshiresult ),0)  / isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  * isnull(( select top 1 isnull(高温补贴标准,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  ","if 岗位人员 = '1' and 有无延时 = '2' and 缺勤天数 > '0' and 公司满勤数 > 0 
   高温补贴 = ( 公司满勤数 - 缺勤天数 ) / 公司满勤数 * 高温补贴标准 
else
if 岗位人员 = '1' and ( 有无延时 = '2' or ( 平时出勤数 + 加班天数 + 节假日出勤数 - 缺勤天数 ) >= 公司满勤数 ) 
   高温补贴 = 高温补贴标准 
else
if 岗位人员 = '1' and 公司满勤数 > 0 
   高温补贴 = ( 平时出勤数 + 加班天数 + 节假日出勤数 - 缺勤天数 ) / 公司满勤数 * 高温补贴标准 
else
if 计时人员 = '1' or 计件人员 = '1' and 出勤时数 >= 公司满勤数 
   高温补贴 = 高温补贴标准 
else
if 计时人员 = '1' or 计件人员 = '1' and 公司满勤数 > 0 
   高温补贴 = 出勤时数 / 公司满勤数 * 高温补贴标准 ",NULL,NULL,0,1,NULL,02,0,1,NULL,NULL," case when isnull(岗位人员,0) = '1' and isnull(有无延时,0) = '2' and isnull(缺勤天数,0) > '0' and isnull(公司满勤数,0) > 0      then  ( isnull(公司满勤数,0) - isnull(缺勤天数,0) ) / isnull(公司满勤数,0) * isnull(高温补贴标准,0)    when  isnull(岗位人员,0) = '1' and ( isnull(有无延时,0) = '2' or ( isnull(平时出勤数,0) + isnull(加班天数,0) + isnull(节假日出勤数,0) - isnull(缺勤天数,0) ) >= isnull(公司满勤数,0) )      then  isnull(高温补贴标准,0)    when  isnull(岗位人员,0) = '1' and isnull(公司满勤数,0) > 0      then  ( isnull(平时出勤数,0) + isnull(加班天数,0) + isnull(节假日出勤数,0) - isnull(缺勤天数,0) ) / isnull(公司满勤数,0) * isnull(高温补贴标准,0)    when  isnull(计时人员,0) = '1' or isnull(计件人员,0) = '1' and isnull(出勤时数,0) >= isnull(公司满勤数,0)      then  isnull(高温补贴标准,0)    when  isnull(计时人员,0) = '1' or isnull(计件人员,0) = '1' and isnull(公司满勤数,0) > 0      then  isnull(出勤时数,0) / isnull(公司满勤数,0) * isnull(高温补贴标准,0)  end",NULL
迟到扣款,"select ( ( isnull(( select latercount from SalarygongshiItem),0)  * ( isnull(( select latercount from SalarygongshiItem),0)  + 1 ) ) / 2 )  * 15 ","迟到扣款 = ( ( 迟到次数 * ( 迟到次数 + 1 ) ) / 2 )  * 15 ",NULL,NULL,0,0,NULL,01,0,1,NULL,NULL,"  ( ( isnull(latercount,0) * ( isnull(latercount,0) + 1 ) ) / 2 )  * 15 ",NULL
旷工扣款,"if isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  > 0 and isnull(( select top 1 isnull(岗位人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1     select isnull(( select top 1 isnull(平时出勤工资,0) from gongshiresult ),0)  / isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  * isnull(( select absentdays from SalarygongshiItem),0)   else if isnull(( select top 1 isnull(计时人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1     select isnull(( select top 1 isnull(小时工资,0) from gongshiresult ),0)  * isnull(( select absentdays from SalarygongshiItem),0)  / 8  else if isnull(( select top 1 isnull(计件人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1 and isnull(( select top 1 isnull(出勤时数,0) from gongshiresult ),0)  > 0     select isnull(( select top 1 isnull(计算月工资,0) from gongshiresult ),0)  / isnull(( select top 1 isnull(出勤时数,0) from gongshiresult ),0)  * isnull(( select absentdays from SalarygongshiItem),0)  / 8 ","if 公司满勤数 > 0 and 岗位人员 = 1 
   旷工扣款 = 平时出勤工资 / 公司满勤数 * 旷工天数 
else
if 计时人员 = 1 
   旷工扣款 = 小时工资 * 旷工天数 / 8 
else
if 计件人员 = 1 and 出勤时数 > 0 
   旷工扣款 = 计算月工资 / 出勤时数 * 旷工天数 / 8 ",NULL,NULL,0,0,NULL,06,0,1,NULL,NULL," case when isnull(公司满勤数,0) > 0 and isnull(岗位人员,0) = 1      then  isnull(平时出勤工资,0) / isnull(公司满勤数,0) * isnull(absentdays,0)    when  isnull(计时人员,0) = 1      then  isnull(小时工资,0) * isnull(absentdays,0) / 8    when  isnull(计件人员,0) = 1 and isnull(出勤时数,0) > 0      then  isnull(计算月工资,0) / isnull(出勤时数,0) * isnull(absentdays,0) / 8  end",NULL
考试工资,"if isnull(( select top 1 isnull(岗位人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1  select ( isnull(( select top 1 isnull(计算月工资,0) from gongshiresult ),0)  * isnull(( select top 1 isnull(考试得分,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  ) / 100  else  if isnull(( select top 1 isnull(DepartmentCode3,0) from employee e where e.id=EMPID),0)  = '动力装备部' or isnull(( select top 1 isnull(DepartmentCode4,0) from employee e where e.id=EMPID),0)  like '品质%' and isnull(( select top 1 isnull(计时人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1  select isnull(( select top 1 isnull(计算月工资,0) from gongshiresult ),0)  * isnull(( select top 1 isnull(考试得分,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  / 100  else  if isnull(( select top 1 isnull(DepartmentCode3,0) from employee e where e.id=EMPID),0)  = '销售中心' and isnull(( select top 1 isnull(出勤时数,0) from gongshiresult ),0)  >= isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  and isnull(( select top 1 isnull(计件人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1  select 4000 * isnull(( select top 1 isnull(考试得分,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  / 100  else  if isnull(( select top 1 isnull(DepartmentCode3,0) from employee e where e.id=EMPID),0)  = '销售中心' and isnull(( select top 1 isnull(出勤时数,0) from gongshiresult ),0)  < isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  and isnull(( select top 1 isnull(计件人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1 and isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  > 0  select 4000 * isnull(( select top 1 isnull(考试得分,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  / 100 * isnull(( select top 1 isnull(出勤时数,0) from gongshiresult ),0)  / isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)   else  if isnull(( select top 1 isnull(出勤时数,0) from gongshiresult ),0)  > isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  and ( isnull(( select top 1 isnull(计时人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1 or isnull(( select top 1 isnull(计件人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1 )  select 8000 * isnull(( select top 1 isnull(考试得分,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  / 100  else  if isnull(( select top 1 isnull(计时人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1 or isnull(( select top 1 isnull(计件人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1 and isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  > 0  select 8000 * isnull(( select top 1 isnull(考试得分,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  / 100 * isnull(( select top 1 isnull(出勤时数,0) from gongshiresult ),0)  / isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  ","if 岗位人员 = 1 
考试工资 = ( 计算月工资 * 考试得分 ) / 100 
else 
if 三级部门 = '动力装备部' or 四级部门 like '品质%' and 计时人员 = 1 
考试工资 = 计算月工资 * 考试得分 / 100 
else 
if 三级部门 = '销售中心' and 出勤时数 >= 公司满勤数 and 计件人员 = 1 
考试工资 = 4000 * 考试得分 / 100 
else 
if 三级部门 = '销售中心' and 出勤时数 < 公司满勤数 and 计件人员 = 1 and 公司满勤数 > 0 
考试工资 = 4000 * 考试得分 / 100 * 出勤时数 / 公司满勤数 
else 
if 出勤时数 > 公司满勤数 and ( 计时人员 = 1 or 计件人员 = 1 ) 
考试工资 = 8000 * 考试得分 / 100 
else 
if 计时人员 = 1 or 计件人员 = 1 and 公司满勤数 > 0 
考试工资 = 8000 * 考试得分 / 100 * 出勤时数 / 公司满勤数 ",NULL,NULL,0,1,NULL,06,0,1,NULL,NULL," case when isnull(岗位人员,0) = 1   then  ( isnull(计算月工资,0) * isnull(考试得分,0) ) / 100    when  isnull(DepartmentCode3,0) = '动力装备部' or isnull(DepartmentCode4,0) like '品质%' and isnull(计时人员,0) = 1   then  isnull(计算月工资,0) * isnull(考试得分,0) / 100    when  isnull(DepartmentCode3,0) = '销售中心' and isnull(出勤时数,0) >= isnull(公司满勤数,0) and isnull(计件人员,0) = 1   then  4000 * isnull(考试得分,0) / 100    when  isnull(DepartmentCode3,0) = '销售中心' and isnull(出勤时数,0) < isnull(公司满勤数,0) and isnull(计件人员,0) = 1 and isnull(公司满勤数,0) > 0   then  4000 * isnull(考试得分,0) / 100 * isnull(出勤时数,0) / isnull(公司满勤数,0)    when  isnull(出勤时数,0) > isnull(公司满勤数,0) and ( isnull(计时人员,0) = 1 or isnull(计件人员,0) = 1 )   then  8000 * isnull(考试得分,0) / 100    when  isnull(计时人员,0) = 1 or isnull(计件人员,0) = 1 and isnull(公司满勤数,0) > 0   then  8000 * isnull(考试得分,0) / 100 * isnull(出勤时数,0) / isnull(公司满勤数,0)  end",NULL
带薪年假工资,"if isnull(( select top 1 isnull(是否计算年假,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  <> 1     select 0  else if isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  > 0 and isnull(( select top 1 isnull(岗位人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1  select ( isnull(( select top 1 isnull(平时出勤工资,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(加班工资,0) from gongshiresult ),0)  ) / isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  * isnull(( select top 1 isnull(带薪年假天数,0) from gongshiresult ),0)   else  if isnull(( select top 1 isnull(计时人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1  select ( isnull(( select top 1 isnull(带薪年假天数,0) from gongshiresult ),0)  * 8 ) * isnull(( select top 1 isnull(小时工资,0) from gongshiresult ),0)   else  if isnull(( select top 1 isnull(计件人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1  select isnull(( select top 1 isnull(带薪年假天数,0) from gongshiresult ),0)  * 120 ","if 是否计算年假 <> 1 
   带薪年假工资 = 0 
else
if 公司满勤数 > 0 and 岗位人员 = 1 
带薪年假工资 = ( 平时出勤工资 + 加班工资 ) / 公司满勤数 * 带薪年假天数 
else 
if 计时人员 = 1 
带薪年假工资 = ( 带薪年假天数 * 8 ) * 小时工资 
else 
if 计件人员 = 1 
带薪年假工资 = 带薪年假天数 * 120 ",NULL,NULL,0,1,NULL,04,0,1,NULL,NULL," case when isnull(是否计算年假,0) <> 1      then  0    when  isnull(公司满勤数,0) > 0 and isnull(岗位人员,0) = 1   then  ( isnull(平时出勤工资,0) + isnull(加班工资,0) ) / isnull(公司满勤数,0) * isnull(带薪年假天数,0)    when  isnull(计时人员,0) = 1   then  ( isnull(带薪年假天数,0) * 8 ) * isnull(小时工资,0)    when  isnull(计件人员,0) = 1   then  isnull(带薪年假天数,0) * 120  end",NULL
应发合计,"if isnull(( select top 1 isnull(岗位人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1  select isnull(( select top 1 isnull(计算月工资,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(带薪年假工资,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(考核工资,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(季度考核工资,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(考试工资,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(销售产能工资,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(学历补贴,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(职称补贴,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(高温补贴,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(岗位津贴,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  + isnull(( select top 1 isnull(交通补贴,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  + isnull(( select top 1 isnull(夜班补贴,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(合理化提案,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  + isnull(( select top 1 isnull(奖金,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(赔偿,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(迟到扣款,0) from gongshiresult ),0)  - isnull(( select top 1 isnull(其他扣款,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(旷工扣款,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(年终奖,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)   else  if isnull(( select top 1 isnull(计时人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1  select isnull(( select top 1 isnull(计算月工资,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(带薪年假工资,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(考评工资,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(季度考评工资,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(考试工资,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(学历补贴,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(职称补贴,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(高温补贴,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(岗位津贴,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  + isnull(( select top 1 isnull(交通补贴,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  + isnull(( select top 1 isnull(合理化提案,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  + isnull(( select top 1 isnull(奖金,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(赔偿,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(迟到扣款,0) from gongshiresult ),0)  - isnull(( select top 1 isnull(其他扣款,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(旷工扣款,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(年终奖,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  else  if isnull(( select top 1 isnull(计件人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1  select isnull(( select top 1 isnull(计算月工资计件,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  + isnull(( select top 1 isnull(带薪年假工资,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(考评工资,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(考试工资,0) from gongshiresult ),0)  - isnull(( select top 1 isnull(刀费扣款,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  + isnull(( select top 1 isnull(刀费补贴,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  + isnull(( select top 1 isnull(学历补贴,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(职称补贴,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(高温补贴,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(岗位津贴,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  + isnull(( select top 1 isnull(交通补贴,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  + isnull(( select top 1 isnull(合理化提案,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  + isnull(( select top 1 isnull(奖金,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(赔偿,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(迟到扣款,0) from gongshiresult ),0)  - isnull(( select top 1 isnull(其他扣款,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(旷工扣款,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(年终奖,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  ","if 岗位人员 = 1 
应发合计 = 计算月工资 + 带薪年假工资 + 考核工资 + 季度考核工资 + 考试工资 + 销售产能工资 + 学历补贴 + 职称补贴 + 高温补贴 + 岗位津贴 + 交通补贴 + 夜班补贴 + 合理化提案 + 奖金 - 赔偿 - 迟到扣款 - 其他扣款 - 旷工扣款 + 年终奖 
else 
if 计时人员 = 1 
应发合计 = 计算月工资 + 带薪年假工资 + 考评工资 + 季度考评工资 + 考试工资 + 学历补贴 + 职称补贴 + 高温补贴 + 岗位津贴 + 交通补贴 + 合理化提案 + 奖金 - 赔偿 - 迟到扣款 - 其他扣款 - 旷工扣款 + 年终奖
else 
if 计件人员 = 1 
应发合计 = 计算月工资计件 + 带薪年假工资 + 考评工资 + 考试工资 - 刀费扣款 + 刀费补贴 + 学历补贴 + 职称补贴 + 高温补贴 + 岗位津贴 + 交通补贴 + 合理化提案 + 奖金 - 赔偿 - 迟到扣款 - 其他扣款 - 旷工扣款 + 年终奖 ",NULL,NULL,1,1,NULL,07,1,1,NULL,NULL," case when isnull(岗位人员,0) = 1   then  isnull(计算月工资,0) + isnull(带薪年假工资,0) + isnull(考核工资,0) + isnull(季度考核工资,0) + isnull(考试工资,0) + isnull(销售产能工资,0) + isnull(学历补贴,0) + isnull(职称补贴,0) + isnull(高温补贴,0) + isnull(岗位津贴,0) + isnull(交通补贴,0) + isnull(夜班补贴,0) + isnull(合理化提案,0) + isnull(奖金,0) - isnull(赔偿,0) - isnull(迟到扣款,0) - isnull(其他扣款,0) - isnull(旷工扣款,0) + isnull(年终奖,0)    when  isnull(计时人员,0) = 1   then  isnull(计算月工资,0) + isnull(带薪年假工资,0) + isnull(考评工资,0) + isnull(季度考评工资,0) + isnull(考试工资,0) + isnull(学历补贴,0) + isnull(职称补贴,0) + isnull(高温补贴,0) + isnull(岗位津贴,0) + isnull(交通补贴,0) + isnull(合理化提案,0) + isnull(奖金,0) - isnull(赔偿,0) - isnull(迟到扣款,0) - isnull(其他扣款,0) - isnull(旷工扣款,0) + isnull(年终奖,0)   when  isnull(计件人员,0) = 1   then  isnull(计算月工资计件,0) + isnull(带薪年假工资,0) + isnull(考评工资,0) + isnull(考试工资,0) - isnull(刀费扣款,0) + isnull(刀费补贴,0) + isnull(学历补贴,0) + isnull(职称补贴,0) + isnull(高温补贴,0) + isnull(岗位津贴,0) + isnull(交通补贴,0) + isnull(合理化提案,0) + isnull(奖金,0) - isnull(赔偿,0) - isnull(迟到扣款,0) - isnull(其他扣款,0) - isnull(旷工扣款,0) + isnull(年终奖,0)  end",NULL
扣款合计,"select 0 ","扣款合计 = 0 ",NULL,NULL,0,1,NULL,01,0,1,NULL,NULL,"  0 ",NULL
实发合计,"if isnull(( select top 1 isnull(岗位人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1  select isnull(( select top 1 isnull(应发合计,0) from gongshiresult ),0)  - isnull(( select top 1 isnull(社会保险公积金,0) from gongshiresult ),0)  - isnull(( select top 1 isnull(个人所得税,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(停发工资,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(已领当月工资,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(服装扣款,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(代扣水电费,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(代扣饭卡充值,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  + isnull(( select top 1 isnull(一次性补偿金,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(扣个人借款,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(代扣税,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(股权激励个税扣款,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)   else  if isnull(( select top 1 isnull(计时人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1 or isnull(( select top 1 isnull(计件人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1  select isnull(( select top 1 isnull(应发合计,0) from gongshiresult ),0)  - isnull(( select top 1 isnull(社会保险公积金,0) from gongshiresult ),0)  - isnull(( select top 1 isnull(个人所得税,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(停发工资,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(已领当月工资,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(服装扣款,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(代扣水电费,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(代扣饭卡充值,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  + isnull(( select top 1 isnull(一次性补偿金,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(扣个人借款,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(代扣税,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  ","if 岗位人员 = 1 
实发合计 = 应发合计 - 社会保险公积金 - 个人所得税 - 停发工资 - 已领当月工资 - 服装扣款 - 代扣水电费 - 代扣饭卡充值 + 一次性补偿金 - 扣个人借款 - 代扣税 - 股权激励个税扣款 
else 
if 计时人员 = 1 or 计件人员 = 1 
实发合计 = 应发合计 - 社会保险公积金 - 个人所得税 - 停发工资 - 已领当月工资 - 服装扣款 - 代扣水电费 - 代扣饭卡充值 + 一次性补偿金 - 扣个人借款 - 代扣税 ",NULL,NULL,0,1,NULL,08,0,1,NULL,NULL," case when isnull(岗位人员,0) = 1   then  isnull(应发合计,0) - isnull(社会保险公积金,0) - isnull(个人所得税,0) - isnull(停发工资,0) - isnull(已领当月工资,0) - isnull(服装扣款,0) - isnull(代扣水电费,0) - isnull(代扣饭卡充值,0) + isnull(一次性补偿金,0) - isnull(扣个人借款,0) - isnull(代扣税,0) - isnull(股权激励个税扣款,0)    when  isnull(计时人员,0) = 1 or isnull(计件人员,0) = 1   then  isnull(应发合计,0) - isnull(社会保险公积金,0) - isnull(个人所得税,0) - isnull(停发工资,0) - isnull(已领当月工资,0) - isnull(服装扣款,0) - isnull(代扣水电费,0) - isnull(代扣饭卡充值,0) + isnull(一次性补偿金,0) - isnull(扣个人借款,0) - isnull(代扣税,0)  end",NULL
社会保险公积金,"select isnull(( select top 1 isnull(保险金扣款,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(医疗保险,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(失业保险,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(住房公积金,0) from gongshiresult ),0)  ","社会保险公积金 = 保险金扣款 + 医疗保险 + 失业保险 + 住房公积金 ",NULL,NULL,1,0,NULL,01,0,1,NULL,NULL,"  isnull(保险金扣款,0) + isnull(医疗保险,0) + isnull(失业保险,0) + isnull(住房公积金,0) ",NULL
基本工资,"if isnull(( select top 1 isnull(岗位人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1     select isnull(( select top 1 isnull(计算月工资,0) from gongshiresult ),0)   else if isnull(( select top 1 isnull(计件人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1     select isnull(( select top 1 isnull(计算月工资计件,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  + isnull(( select top 1 isnull(考评工资,0) from gongshiresult ),0)   else if isnull(( select top 1 isnull(计时人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1     select isnull(( select top 1 isnull(计算月工资,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(考评工资,0) from gongshiresult ),0)  ","if 岗位人员 = 1 
   基本工资 = 计算月工资 
else
if 计件人员 = 1 
   基本工资 = 计算月工资计件 + 考评工资 
else
if 计时人员 = 1 
   基本工资 = 计算月工资 + 考评工资 ",NULL,NULL,0,1,NULL,07,0,1,NULL,NULL," case when isnull(岗位人员,0) = 1      then  isnull(计算月工资,0)    when  isnull(计件人员,0) = 1      then  isnull(计算月工资计件,0) + isnull(考评工资,0)    when  isnull(计时人员,0) = 1      then  isnull(计算月工资,0) + isnull(考评工资,0)  end",NULL
销售产能工资,"if isnull(( select top 1 isnull(岗位人员,0) from XZ_FixItemPay where ID=EMPID  and SelMonth=MYDATE),0)  = 1     select isnull(( select top 1 isnull(计算月工资,0) from gongshiresult ),0)  * ( isnull(( select top 1 isnull(销售产能系数,0) from XZ_ChgItemPay where ID=EMPID  and SelMonth=MYDATE),0)  - 1 ) ","if 岗位人员 = 1 
   销售产能工资 = 计算月工资 * ( 销售产能系数 - 1 ) ",NULL,NULL,0,1,NULL,06,0,1,NULL,NULL," case when isnull(岗位人员,0) = 1      then  isnull(计算月工资,0) * ( isnull(销售产能系数,0) - 1 )  end",NULL
专项扣除,"select isnull(( select top 1 isnull(个税专项抵扣合计,0) from gongshiresult ),0)  ","专项扣除 = 个税专项抵扣合计 ",NULL,NULL,0,1,NULL,02,0,1,NULL,NULL,"  isnull(个税专项抵扣合计,0) ",NULL
月薪,"if isnull(( select top 1 isnull(岗位人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1 and isnull(( select top 1 isnull(postname,'') from HR_Post p join employee e on e.WorkPostId = p.id where e.id=EMPID),0)  = '计划员'     select isnull(( select basepay_jibie from SalarygongshiItem),0)  / 30 * 22  else if isnull(( select top 1 isnull(岗位人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1 and isnull(( select top 1 isnull(有无延时,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1     select isnull(( select basepay_jibie from SalarygongshiItem),0)  / 26 * 22  else if isnull(( select top 1 isnull(岗位人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1 and isnull(( select top 1 isnull(有无延时,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 2     select isnull(( select basepay_jibie from SalarygongshiItem),0)   else if isnull(( select top 1 isnull(岗位人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1 and isnull(( select top 1 isnull(有无延时,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 0     select isnull(( select basepay_jibie from SalarygongshiItem),0)  / 25 * 22 ","if 岗位人员 = 1 and 岗位名称 = '计划员' 
   月薪 = 工资级别 / 30 * 22 
else
if 岗位人员 = 1 and 有无延时 = 1 
   月薪 = 工资级别 / 26 * 22 
else
if 岗位人员 = 1 and 有无延时 = 2 
   月薪 = 工资级别 
else
if 岗位人员 = 1 and 有无延时 = 0 
   月薪 = 工资级别 / 25 * 22 ",NULL,NULL,0,1,NULL,01,0,1,NULL,NULL," case when isnull(岗位人员,0) = 1 and isnull(postname,'') = '计划员'      then  isnull(basepay_jibie,0) / 30 * 22    when  isnull(岗位人员,0) = 1 and isnull(有无延时,0) = 1      then  isnull(basepay_jibie,0) / 26 * 22    when  isnull(岗位人员,0) = 1 and isnull(有无延时,0) = 2      then  isnull(basepay_jibie,0)    when  isnull(岗位人员,0) = 1 and isnull(有无延时,0) = 0      then  isnull(basepay_jibie,0) / 25 * 22  end",NULL
平时出勤数,"select isnull(( select top 1 isnull(法定满勤数,0) from XZ_ChgItemPay where ID=EMPID  and SelMonth=MYDATE),0)  ","平时出勤数 = 法定满勤数 ",NULL,NULL,0,1,NULL,01,0,1,NULL,NULL,"  isnull(法定满勤数,0) ",NULL
加班天数,"select isnull(( select overtime_c from SalarygongshiItem),0)  / 8 ","加班天数 = 平时加班小时 / 8 ",NULL,NULL,0,1,NULL,01,0,1,NULL,NULL,"  isnull(overtime_c,0) / 8 ",NULL
节假日出勤数,"select isnull(( select overtime_h from SalarygongshiItem),0)  ","节假日出勤数 = 节日加班小时 ",NULL,NULL,0,1,NULL,01,0,1,NULL,NULL,"  isnull(overtime_h,0) ",NULL
平时出勤工资,"select isnull(( select top 1 isnull(月薪,0) from gongshiresult ),0)  ","平时出勤工资 = 月薪 ",NULL,NULL,0,1,NULL,02,0,1,NULL,NULL,"  isnull(月薪,0) ",NULL
出勤时数,"select isnull(( select work_hours from SalarygongshiItem),0)  ","出勤时数 = 实际出勤小时 ",NULL,NULL,0,1,NULL,01,0,1,NULL,NULL,"  isnull(work_hours,0) ",NULL
小时工资,"if isnull(( select top 1 isnull(计时人员,0) from XZ_FixItemPay where ID=EMPID  and SelMonth=MYDATE),0)  = 1     select isnull(( select basepay_jibie from SalarygongshiItem),0)  ","if 计时人员 = 1 
   小时工资 = 工资级别 ",NULL,NULL,0,1,NULL,01,0,1,NULL,NULL," case when isnull(计时人员,0) = 1      then  isnull(basepay_jibie,0)  end",NULL
周六天数,"if isnull(( select manpay_flag from SalarygongshiItem),0)  = 1 and isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  < 31 or isnull(( select top 1 isnull(法定满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  < 31     select isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(法定满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)   else if isnull(( select manpay_flag from SalarygongshiItem),0)  = 3     select ( isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(法定满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  ) / 8 ","if 工资类型 = 1 and 公司满勤数 < 31 or 法定满勤数 < 31 
   周六天数 = 公司满勤数 - 法定满勤数 
else
if 工资类型 = 3 
   周六天数 = ( 公司满勤数 - 法定满勤数 ) / 8 ",NULL,NULL,0,1,NULL,01,0,1,NULL,NULL," case when isnull(manpay_flag,'') = 1 and isnull(公司满勤数,0) < 31 or isnull(法定满勤数,0) < 31      then  isnull(公司满勤数,0) - isnull(法定满勤数,0)    when  isnull(manpay_flag,'') = 3      then  ( isnull(公司满勤数,0) - isnull(法定满勤数,0) ) / 8  end",NULL
加班工资计件,"select isnull(( select top 1 isnull(标准小时工资,0) from XZ_ChgItemPay where ID=EMPID  and SelMonth=MYDATE),0)  * 0.5 ","加班工资计件 = 标准小时工资 * 0.5 ",NULL,NULL,0,1,NULL,01,0,1,NULL,NULL,"  isnull(标准小时工资,0) * 0.5 ",NULL
实际月份,"select isnull(( select monthgongling from SalarygongshiItem),0)  ","实际月份 = 工龄月龄 ",NULL,NULL,0,1,NULL,01,0,1,NULL,NULL,"  isnull(monthgongling,0) ",NULL
工龄奖,"if month ( isnull(( select Month from SalarygongshiItem),0)  ) <> 5     select 0  else if dateadd ( year , -1 , isnull(( select Month from SalarygongshiItem),0)  ) >= isnull(( select top 1 HIREDATE from employee e where e.id=EMPID),0)  and dateadd ( year , -2 , isnull(( select Month from SalarygongshiItem),0)  ) < isnull(( select top 1 HIREDATE from employee e where e.id=EMPID),0)      select 1000 * ( 12 - isnull(( select top 1 isnull(年请假月数,0) from gongshiresult ),0)  ) / 12  else if dateadd ( year , -2 , isnull(( select Month from SalarygongshiItem),0)  ) >= isnull(( select top 1 HIREDATE from employee e where e.id=EMPID),0)  and dateadd ( year , -3 , isnull(( select Month from SalarygongshiItem),0)  ) < isnull(( select top 1 HIREDATE from employee e where e.id=EMPID),0)      select 1500 * ( 12 - isnull(( select top 1 isnull(年请假月数,0) from gongshiresult ),0)  ) / 12  else if dateadd ( year , -3 , isnull(( select Month from SalarygongshiItem),0)  ) >= isnull(( select top 1 HIREDATE from employee e where e.id=EMPID),0)  and dateadd ( year , -5 , isnull(( select Month from SalarygongshiItem),0)  ) < isnull(( select top 1 HIREDATE from employee e where e.id=EMPID),0)      select 2000 * ( 12 - isnull(( select top 1 isnull(年请假月数,0) from gongshiresult ),0)  ) / 12  else if dateadd ( year , -5 , isnull(( select Month from SalarygongshiItem),0)  ) >= isnull(( select top 1 HIREDATE from employee e where e.id=EMPID),0)  and dateadd ( year , -10 , isnull(( select Month from SalarygongshiItem),0)  ) < isnull(( select top 1 HIREDATE from employee e where e.id=EMPID),0)      select 2500 * ( 12 - isnull(( select top 1 isnull(年请假月数,0) from gongshiresult ),0)  ) / 12  else if dateadd ( year , -10 , isnull(( select Month from SalarygongshiItem),0)  ) >= isnull(( select top 1 HIREDATE from employee e where e.id=EMPID),0)      select 3000 * ( 12 - isnull(( select top 1 isnull(年请假月数,0) from gongshiresult ),0)  ) / 12 ","if month ( 薪酬统计月份 ) <> 5 
   工龄奖 = 0 
else
if dateadd ( year , -1 , 薪酬统计月份 ) >= 入职日期 and dateadd ( year , -2 , 薪酬统计月份 ) < 入职日期 
   工龄奖 = 1000 * ( 12 - 年请假月数 ) / 12 
else
if dateadd ( year , -2 , 薪酬统计月份 ) >= 入职日期 and dateadd ( year , -3 , 薪酬统计月份 ) < 入职日期 
   工龄奖 = 1500 * ( 12 - 年请假月数 ) / 12 
else
if dateadd ( year , -3 , 薪酬统计月份 ) >= 入职日期 and dateadd ( year , -5 , 薪酬统计月份 ) < 入职日期 
   工龄奖 = 2000 * ( 12 - 年请假月数 ) / 12 
else
if dateadd ( year , -5 , 薪酬统计月份 ) >= 入职日期 and dateadd ( year , -10 , 薪酬统计月份 ) < 入职日期 
   工龄奖 = 2500 * ( 12 - 年请假月数 ) / 12 
else
if dateadd ( year , -10 , 薪酬统计月份 ) >= 入职日期 
   工龄奖 = 3000 * ( 12 - 年请假月数 ) / 12 ",NULL,NULL,0,1,NULL,02,0,1,NULL,NULL," case when month ( isnull(Month,0) ) <> 5      then  0    when  dateadd ( year , -1 , isnull(Month,0) ) >= isnull(HIREDATE,0) and dateadd ( year , -2 , isnull(Month,0) ) < isnull(HIREDATE,0)      then  1000 * ( 12 - isnull(年请假月数,0) ) / 12    when  dateadd ( year , -2 , isnull(Month,0) ) >= isnull(HIREDATE,0) and dateadd ( year , -3 , isnull(Month,0) ) < isnull(HIREDATE,0)      then  1500 * ( 12 - isnull(年请假月数,0) ) / 12    when  dateadd ( year , -3 , isnull(Month,0) ) >= isnull(HIREDATE,0) and dateadd ( year , -5 , isnull(Month,0) ) < isnull(HIREDATE,0)      then  2000 * ( 12 - isnull(年请假月数,0) ) / 12    when  dateadd ( year , -5 , isnull(Month,0) ) >= isnull(HIREDATE,0) and dateadd ( year , -10 , isnull(Month,0) ) < isnull(HIREDATE,0)      then  2500 * ( 12 - isnull(年请假月数,0) ) / 12    when  dateadd ( year , -10 , isnull(Month,0) ) >= isnull(HIREDATE,0)      then  3000 * ( 12 - isnull(年请假月数,0) ) / 12  end",NULL
年请假月数,"select floor ( isnull(( select top 1 isnull(年请假总天数,0) from XZ_ChgItemPay where ID=EMPID  and SelMonth=MYDATE),0)  / 30 ) ","年请假月数 = floor ( 年请假总天数 / 30 ) ",NULL,NULL,0,1,NULL,01,0,1,NULL,NULL,"  floor ( isnull(年请假总天数,0) / 30 ) ",NULL
学历补贴标准,"if isnull(( select top 1 egrade from employee e where e.id=EMPID),0)  like '大专%'     select 100  else if isnull(( select top 1 egrade from employee e where e.id=EMPID),0)  = '本科-非全日制'     select 150  else if isnull(( select top 1 egrade from employee e where e.id=EMPID),0)  = '本科'     select 300  else if isnull(( select top 1 egrade from employee e where e.id=EMPID),0)  = '本科-211' or isnull(( select top 1 egrade from employee e where e.id=EMPID),0)  = '硕士-非全日制'     select 500  else if isnull(( select top 1 egrade from employee e where e.id=EMPID),0)  = '硕士'     select 800  else if isnull(( select top 1 egrade from employee e where e.id=EMPID),0)  = '硕士-211'     select 1000  else if isnull(( select top 1 egrade from employee e where e.id=EMPID),0)  = '博士'     select 2000 ","if 文化程度 like '大专%' 
   学历补贴标准 = 100 
else
if 文化程度 = '本科-非全日制' 
   学历补贴标准 = 150 
else
if 文化程度 = '本科' 
   学历补贴标准 = 300 
else
if 文化程度 = '本科-211' or 文化程度 = '硕士-非全日制' 
   学历补贴标准 = 500 
else
if 文化程度 = '硕士' 
   学历补贴标准 = 800 
else
if 文化程度 = '硕士-211' 
   学历补贴标准 = 1000 
else
if 文化程度 = '博士' 
   学历补贴标准 = 2000 ",NULL,NULL,0,1,NULL,01,0,1,NULL,NULL," case when isnull(egrade,'') like '大专%'      then  100    when  isnull(egrade,'') = '本科-非全日制'      then  150    when  isnull(egrade,'') = '本科'      then  300    when  isnull(egrade,'') = '本科-211' or isnull(egrade,'') = '硕士-非全日制'      then  500    when  isnull(egrade,'') = '硕士'      then  800    when  isnull(egrade,'') = '硕士-211'      then  1000    when  isnull(egrade,'') = '博士'      then  2000  end",NULL
加班时数,"if isnull(( select top 1 isnull(计时人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1 and isnull(( select top 1 isnull(出勤时数,0) from gongshiresult ),0)  > isnull(( select top 1 isnull(法定满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)      select isnull(( select top 1 isnull(出勤时数,0) from gongshiresult ),0)  - isnull(( select top 1 isnull(法定满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  ","if 计时人员 = 1 and 出勤时数 > 法定满勤数 
   加班时数 = 出勤时数 - 法定满勤数 ",NULL,NULL,0,1,NULL,02,0,1,NULL,NULL," case when isnull(计时人员,0) = 1 and isnull(出勤时数,0) > isnull(法定满勤数,0)      then  isnull(出勤时数,0) - isnull(法定满勤数,0)  end",NULL
考评工资,"if isnull(( select top 1 isnull(DepartmentCode3,0) from employee e where e.id=EMPID),0)  = '动力装备部' and isnull(( select top 1 isnull(计时人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1  select isnull(( select top 1 isnull(计算月工资,0) from gongshiresult ),0)  * isnull(( select top 1 isnull(考评系数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  * 0.5 * 0.08  else  if isnull(( select top 1 isnull(DepartmentCode4,0) from employee e where e.id=EMPID),0)  like '品质%' and isnull(( select top 1 isnull(计时人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1  select isnull(( select top 1 isnull(计算月工资,0) from gongshiresult ),0)  * ( isnull(( select top 1 isnull(考评系数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - 1 )  else  if isnull(( select top 1 isnull(出勤时数,0) from gongshiresult ),0)  > isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  and ( isnull(( select top 1 isnull(计时人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1 or isnull(( select top 1 isnull(计件人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1 )  select 8000 * 0.08 * isnull(( select top 1 isnull(考评系数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)   else  if isnull(( select top 1 isnull(计时人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1 or isnull(( select top 1 isnull(计件人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1 and isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  > 0  select 8000 * 0.08 * isnull(( select top 1 isnull(出勤时数,0) from gongshiresult ),0)  / isnull(( select top 1 isnull(公司满勤数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  * isnull(( select top 1 isnull(考评系数,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  ","if 三级部门 = '动力装备部' and 计时人员 = 1 
考评工资 = 计算月工资 * 考评系数 * 0.5 * 0.08 
else 
if 四级部门 like '品质%' and 计时人员 = 1 
考评工资 = 计算月工资 * ( 考评系数 - 1 ) 
else 
if 出勤时数 > 公司满勤数 and ( 计时人员 = 1 or 计件人员 = 1 ) 
考评工资 = 8000 * 0.08 * 考评系数 
else 
if 计时人员 = 1 or 计件人员 = 1 and 公司满勤数 > 0 
考评工资 = 8000 * 0.08 * 出勤时数 / 公司满勤数 * 考评系数 ",NULL,NULL,0,1,NULL,06,0,1,NULL,NULL," case when isnull(DepartmentCode3,0) = '动力装备部' and isnull(计时人员,0) = 1   then  isnull(计算月工资,0) * isnull(考评系数,0) * 0.5 * 0.08    when  isnull(DepartmentCode4,0) like '品质%' and isnull(计时人员,0) = 1   then  isnull(计算月工资,0) * ( isnull(考评系数,0) - 1 )    when  isnull(出勤时数,0) > isnull(公司满勤数,0) and ( isnull(计时人员,0) = 1 or isnull(计件人员,0) = 1 )   then  8000 * 0.08 * isnull(考评系数,0)    when  isnull(计时人员,0) = 1 or isnull(计件人员,0) = 1 and isnull(公司满勤数,0) > 0   then  8000 * 0.08 * isnull(出勤时数,0) / isnull(公司满勤数,0) * isnull(考评系数,0)  end",NULL
季度考核工资,"if isnull(( select top 1 isnull(岗位人员,0) from XZ_FixItemPay where ID=EMPID  and SelMonth=MYDATE),0)  = 1     select ( isnull(( select top 1 isnull(计算月工资,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(前两月工资合计,0) from XZ_ChgItemPay where ID=EMPID  and SelMonth=MYDATE),0)  ) * ( isnull(( select top 1 isnull(季度考核系数,0) from XZ_ChgItemPay where ID=EMPID  and SelMonth=MYDATE),0)  - 1 ) ","if 岗位人员 = 1 
   季度考核工资 = ( 计算月工资 + 前两月工资合计 ) * ( 季度考核系数 - 1 ) ",NULL,NULL,0,1,NULL,06,0,1,NULL,NULL," case when isnull(岗位人员,0) = 1      then  ( isnull(计算月工资,0) + isnull(前两月工资合计,0) ) * ( isnull(季度考核系数,0) - 1 )  end",NULL
季度考评工资,"if isnull(( select top 1 isnull(计时人员,0) from XZ_FixItemPay where ID=EMPID  and SelMonth=MYDATE),0)  = 1     select ( isnull(( select top 1 isnull(计算月工资,0) from gongshiresult ),0)  + isnull(( select top 1 isnull(前两月工资合计,0) from XZ_ChgItemPay where ID=EMPID  and SelMonth=MYDATE),0)  ) * 0.5 * 0.08 * isnull(( select top 1 isnull(季度考评系数,0) from XZ_ChgItemPay where ID=EMPID  and SelMonth=MYDATE),0)  ","if 计时人员 = 1 
   季度考评工资 = ( 计算月工资 + 前两月工资合计 ) * 0.5 * 0.08 * 季度考评系数 ",NULL,NULL,0,1,NULL,06,0,1,NULL,NULL," case when isnull(计时人员,0) = 1      then  ( isnull(计算月工资,0) + isnull(前两月工资合计,0) ) * 0.5 * 0.08 * isnull(季度考评系数,0)  end",NULL
职称补贴标准,"if isnull(( select top 1 jobplace from employee e where e.id=EMPID),0)  = '初级职称'     select 150  else if isnull(( select top 1 jobplace from employee e where e.id=EMPID),0)  = '中级职称'     select 300  else if isnull(( select top 1 jobplace from employee e where e.id=EMPID),0)  = '副高级职称'     select 500  else if isnull(( select top 1 jobplace from employee e where e.id=EMPID),0)  = '正高级职称'     select 1000 ","if 工作职称 = '初级职称' 
   职称补贴标准 = 150 
else
if 工作职称 = '中级职称' 
   职称补贴标准 = 300 
else
if 工作职称 = '副高级职称' 
   职称补贴标准 = 500 
else
if 工作职称 = '正高级职称' 
   职称补贴标准 = 1000 ",NULL,NULL,0,1,NULL,01,0,1,NULL,NULL," case when isnull(jobplace,'') = '初级职称'      then  150    when  isnull(jobplace,'') = '中级职称'      then  300    when  isnull(jobplace,'') = '副高级职称'      then  500    when  isnull(jobplace,'') = '正高级职称'      then  1000  end",NULL
缺勤天数,"if isnull(( select yinchuqin_day from SalarygongshiItem),0)  > isnull(( select work_hours from SalarygongshiItem),0)  / 8     select isnull(( select yinchuqin_day from SalarygongshiItem),0)  - isnull(( select work_hours from SalarygongshiItem),0)  / 8","if 应出勤天数 > 实际出勤小时 / 8 
   缺勤天数 = 应出勤天数 - 实际出勤小时 / 8",NULL,NULL,0,1,NULL,01,0,1,NULL,NULL," case when isnull(yinchuqin_day,0) > isnull(work_hours,0) / 8      then  isnull(yinchuqin_day,0) - isnull(work_hours,0) / 8 end",NULL
不计税合计,"if isnull(( select top 1 isnull(岗位人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1  select isnull(( select top 1 isnull(一次性补偿金,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(社会保险公积金,0) from gongshiresult ),0)  - isnull(( select top 1 isnull(停发工资,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(已领当月工资,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(服装扣款,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(代扣水电费,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(代扣饭卡充值,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(扣个人借款,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(代扣税,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(股权激励个税扣款,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)   else  if isnull(( select top 1 isnull(计时人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1 or isnull(( select top 1 isnull(计件人员,0) from XZ_FixItemPay where ID=EMPID and SelMonth=MYDATE),0)  = 1  select isnull(( select top 1 isnull(一次性补偿金,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(社会保险公积金,0) from gongshiresult ),0)  - isnull(( select top 1 isnull(停发工资,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(已领当月工资,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(服装扣款,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(代扣水电费,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(代扣饭卡充值,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(扣个人借款,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  - isnull(( select top 1 isnull(代扣税,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  ","if 岗位人员 = 1 
不计税合计 = 一次性补偿金 - 社会保险公积金 - 停发工资 - 已领当月工资 - 服装扣款 - 代扣水电费 - 代扣饭卡充值 - 扣个人借款 - 代扣税 - 股权激励个税扣款 
else 
if 计时人员 = 1 or 计件人员 = 1 
不计税合计 = 一次性补偿金 - 社会保险公积金 - 停发工资 - 已领当月工资 - 服装扣款 - 代扣水电费 - 代扣饭卡充值 - 扣个人借款 - 代扣税 ",NULL,NULL,0,1,NULL,02,1,1,NULL,NULL," case when isnull(岗位人员,0) = 1   then  isnull(一次性补偿金,0) - isnull(社会保险公积金,0) - isnull(停发工资,0) - isnull(已领当月工资,0) - isnull(服装扣款,0) - isnull(代扣水电费,0) - isnull(代扣饭卡充值,0) - isnull(扣个人借款,0) - isnull(代扣税,0) - isnull(股权激励个税扣款,0)    when  isnull(计时人员,0) = 1 or isnull(计件人员,0) = 1   then  isnull(一次性补偿金,0) - isnull(社会保险公积金,0) - isnull(停发工资,0) - isnull(已领当月工资,0) - isnull(服装扣款,0) - isnull(代扣水电费,0) - isnull(代扣饭卡充值,0) - isnull(扣个人借款,0) - isnull(代扣税,0)  end",NULL
出勤工资,"select isnull(( select top 1 isnull(出勤时数,0) from gongshiresult ),0)  * isnull(( select top 1 isnull(小时工资,0) from gongshiresult ),0)  ","出勤工资 = 出勤时数 * 小时工资 ",NULL,NULL,0,1,NULL,02,0,1,NULL,NULL,"  isnull(出勤时数,0) * isnull(小时工资,0) ",NULL
夜班补贴,"if isnull(( select top 1 isnull(岗位人员,0) from XZ_FixItemPay where ID=EMPID  and SelMonth=MYDATE),0)  = 1 and isnull(( select top 1 isnull(postname,'') from HR_Post p join employee e on e.WorkPostId = p.id where e.id=EMPID),0)  = '警卫'     select isnull(( select nightdays from SalarygongshiItem),0)  * 20 ","if 岗位人员 = 1 and 岗位名称 = '警卫' 
   夜班补贴 = 夜班天数 * 20 ",NULL,NULL,0,1,NULL,01,0,1,NULL,NULL," case when isnull(岗位人员,0) = 1 and isnull(postname,'') = '警卫'      then  isnull(nightdays,0) * 20  end",NULL
带薪年假天数,"if isnull(( select top 1 isnull(是否计算年假,0) from XZ_ChgItemPay where ID=EMPID and SelMonth=MYDATE),0)  <> 1     select 0  else if dateadd ( year , -1 , isnull(( select Month from SalarygongshiItem),0)  ) >= isnull(( select top 1 HIREDATE from employee e where e.id=EMPID),0)  and dateadd ( year , -10 , isnull(( select Month from SalarygongshiItem),0)  ) < isnull(( select top 1 HIREDATE from employee e where e.id=EMPID),0)      select 5  else if dateadd ( year , -10 , isnull(( select Month from SalarygongshiItem),0)  ) >= isnull(( select top 1 HIREDATE from employee e where e.id=EMPID),0)  and dateadd ( year , -20 , isnull(( select Month from SalarygongshiItem),0)  ) < isnull(( select top 1 HIREDATE from employee e where e.id=EMPID),0)      select 10  else if dateadd ( year , -20 , isnull(( select Month from SalarygongshiItem),0)  ) >= isnull(( select top 1 HIREDATE from employee e where e.id=EMPID),0)      select 15 ","if 是否计算年假 <> 1 
   带薪年假天数 = 0 
else
if dateadd ( year , -1 , 薪酬统计月份 ) >= 入职日期 and dateadd ( year , -10 , 薪酬统计月份 ) < 入职日期 
   带薪年假天数 = 5 
else
if dateadd ( year , -10 , 薪酬统计月份 ) >= 入职日期 and dateadd ( year , -20 , 薪酬统计月份 ) < 入职日期 
   带薪年假天数 = 10 
else
if dateadd ( year , -20 , 薪酬统计月份 ) >= 入职日期 
   带薪年假天数 = 15 ",NULL,NULL,0,1,NULL,01,0,1,NULL,NULL," case when isnull(是否计算年假,0) <> 1      then  0    when  dateadd ( year , -1 , isnull(Month,0) ) >= isnull(HIREDATE,0) and dateadd ( year , -10 , isnull(Month,0) ) < isnull(HIREDATE,0)      then  5    when  dateadd ( year , -10 , isnull(Month,0) ) >= isnull(HIREDATE,0) and dateadd ( year , -20 , isnull(Month,0) ) < isnull(HIREDATE,0)      then  10    when  dateadd ( year , -20 , isnull(Month,0) ) >= isnull(HIREDATE,0)      then  15  end",NULL
日期,"select year ( dateadd ( year , 1 , isnull(( select top 1 HIREDATE from employee e where e.id=EMPID),0)  ) ) * 10000 + month ( dateadd ( year , 1 , isnull(( select top 1 HIREDATE from employee e where e.id=EMPID),0)  ) ) * 100 + day ( dateadd ( year , 1 , isnull(( select top 1 HIREDATE from employee e where e.id=EMPID),0)  ) ) ","日期 = year ( dateadd ( year , 1 , 入职日期 ) ) * 10000 + month ( dateadd ( year , 1 , 入职日期 ) ) * 100 + day ( dateadd ( year , 1 , 入职日期 ) ) ",NULL,NULL,0,1,NULL,01,0,1,NULL,NULL,"  year ( dateadd ( year , 1 , isnull(HIREDATE,0) ) ) * 10000 + month ( dateadd ( year , 1 , isnull(HIREDATE,0) ) ) * 100 + day ( dateadd ( year , 1 , isnull(HIREDATE,0) ) ) ",NULL
